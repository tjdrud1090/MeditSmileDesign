using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using Process_Page.ToothTemplate;
using Process_Page.ViewModel;

namespace Process_Page.Cards
{
    using ToothList = ObservableCollection<ObservableCollection<ObservableCollection<PointViewModel>>>;
    using ToothType = ObservableCollection<ObservableCollection<PointViewModel>>;
    using TeethType = ObservableCollection<PointViewModel>;

    public partial class TeethTemplate_Step : UserControl
    {
        #region PointsData

        double[,,] UpperX = {
                             // UT1
                             {{ 31, 56.166667, 67.832847, 76.499812, 77.166473, 64.832947, 13.833529, 5.8339962, 7.5009607, 18.1674 },
                              { 95, 116.16667, 126.83283, 135.16645, 132.16615, 120.83298, 91.16672, 78.166465, 76.499466, 84.499463 },
                              { 170.33333, 175.16699, 177.83314, 167.5004, 156.16734, 128.5006, 125.83395, 129.16757, 138.83409, 155.50049 }},
                             // UT2
                             {{ 24.666667, 56.832999, 65.833427, 73.833909, 78.501026, 70.834163,  12.166018, 4.4987858, 9.8322805, 16.165805 },
                              { 85.333333, 121.167, 128.1666, 132.49952, 131.83287, 113.83318, 87.500299, 75.833832, 75.833832, 77.834119 }, 
                              { 166.33333, 174.16699, 177.83317, 173.50023, 155.8338, 132.83479, 123.50213, 130.8352, 140.83484, 153.83437 }},
                             // UT3
                             {{ 45.333333, 65.833665, 75.834159, 82.167998, 74.8342, 42.500281, 8.1663284, 3.4992231, 10.16604, 23.499675 },
                              { 106, 126.83333, 131.50041, 133.16711, 128.83342, 121.50006, 86.833263, 80.833622, 78.167319, 84.500295 },
                              { 167, 176.16667, 177.83295, 176.16662, 161.83336, 139.50093, 124.83464, 130.16814, 140.16782,  155.50066 } },
                             // UT4
                             {{ 44.666667, 69.166335, 78.165881, 79.165521, 68.165552, 14.833994, 6.5013144, 6.8346347, 12.834404, 23.833981 },
                              { 117.66667, 128.16633, 130.16594, 125.49921, 115.16648, 87.167137, 79.500351, 79.167027, 84.833242, 98.166291 },
                              { 168.33333, 172.50033, 174.16701, 167.16706, 157.16679, 137.16618, 124.83224, 127.49929, 135.16607, 152.49967 } },
                             // UT5
                             {{ 45.666667, 66.166335, 71.832578, 74.832904, 62.833138, 18.166115, 5.1656011, 5.4986075, 12.832078, 28.499037 },
                              { 113.33333, 124.50034, 127.167, 127.83332, 123.16699, 109.50034, 85.833706, 75.500805, 74.834148, 86.167635 },
                              { 171.33333, 174.50033, 171.16699, 164.16594, 144.82966, 131.49502, 124.49414, 130.49488, 139.496, 156.16473 }},
                             // UT6
                             {{ 43, 60.5, 69.833333, 75.167069, 67.833386, 58.500033, 12.833269, 6.1669572, 6.8332918, 16.16664 },
                              { 114.33333, 125.167, 128.16657, 126.16636, 115.16696, 85.835226, 74.836249, 72.1701, 83.502386, 98.168131 },
                              { 170, 174.16667, 171.49988, 163.50051, 144.83533, 129.50372, 123.83755, 131.17051, 144.50255, 159.50109 }},
                             // UT7
                             {{ 46.666667, 68.833001, 77.166792, 76.833126, 67.166419, 13.499531, 6.8328366, 6.8328366, 11.166501, 26.166492 },
                              { 113, 128.5, 130.5, 131.5, 115.5, 85.5, 78.166667, 77.49966, 81.166347, 95.499771 },  
                              { 168.33333, 174.83366, 174.83366, 166.83358, 150.1671, 132.83304, 128.16664, 132.1664, 138.49987, 153.83354 }},
                             // UT8
                             {{ 43, 63.833333, 75.500518, 80.16726, 69.166849, 39.499976, 14.166468, 2.1659904, 5.1657058, 18.832595 },
                              { 110.33333, 127.50034, 132.167, 132.167, 111.83365, 91.167291, 80.167032, 78.500031, 80.833363, 94.16669 },
                              { 161, 175.83333, 174.5003, 172.16691, 160.83333, 144.50033, 134.83367, 132.16735, 135.50036, 147.16701 }},
                             // UT9
                             {{ 48, 69.5, 77.5, 76, 72.5, 41.5, 8.5, 5, 9.5, 22.5 },
                              { 111.5, 128, 131.5, 128.5, 123.5, 103, 83.5,  76.5, 77.5, 89.5 },
                              { 162.5, 177, 171.5, 161.5, 152, 138.5, 129.5, 130.5, 136.5, 146 }},

                            };

        double[,,] UpperY = {
                             // UT1
                             {{ 19.166667, 18.999666, 28.999655, 63.999615, 115.33289, 127.33325, 127.66691, 113.33322,  65.333106, 28.666355 },
                              { 29.833333, 29.833333, 41.000334, 75.000341, 101.33368, 118.00076, 120.33411, 102.00095, 64.333962, 39.667085 },
                              { 16.833333, 48.000334, 75.333671, 107.66752, 127.00057, 109.66719, 83.333807, 58.333754, 37.33371, 20.000341 }},
                             // UT2
                             {{ 14.5, 14.333333, 21.652376, 61.237815,  105.48138, 123.44441, 124.44203, 113.79681, 59.907081, 24.978551 },
                              { 26.166667, 25.332999, 42.992922, 69.982099, 101.63608, 118.29566, 117.2964, 98.637224, 68.982468, 43.992506 },
                              { 14.5, 33, 59, 93, 125.33333, 102.00027, 82.666873, 52.000114, 34.000059, 23.000026 }},
                             // UT3
                             {{ 18.5, 25.666667, 45.665401, 79.996381, 110.99456, 115.99427, 108.99467, 84.996087, 49.998146, 24.33299 },
                              { 30.166667, 33.666333, 56.330504, 82.995303, 102.99365, 112.65951, 110.65936, 98.9937, 74.329171, 49.664643 },
                              { 29.833333, 45.333667, 69.667858, 106.00134, 127.33496, 116.33511, 89.001321, 61.000854, 46.667282, 36.000437 }},
                             // UT4
                             {{ 22.166667, 35.332999, 65.334095, 107.66916, 127.66941, 127.66941, 117.00213, 87.001353, 56.66723, 35 },
                              { 30.833333, 45.333667, 75.334692, 109.33607, 124.00358, 123.67023, 110.33644, 85.335565, 60.668039,  38.000584 },
                              { 16.833333, 36.000334, 63.667005, 88.999825, 124.66624, 121.66593, 103.99945, 70.999783, 46.333367, 24.333591 } },
                             // UT5
                             {{ 34.833333, 43.000332, 76.000331, 103.66699, 125.99988, 126.99988, 108.3333, 79.000114, 54.333569, 39.333643 },
                              { 27.833333, 36.333667, 63.668408, 87.33545, 107.66984, 119.33654, 121.33694, 107.00339, 70.001962, 41.000842 },
                              { 26.833333, 54.333667, 80.334317, 101.66838, 125.66838, 114.00126, 93.667708, 70.667465, 50.667253, 35.333757 }},
                             // UT6
                             {{ 32.833333, 37.333665, 63.335915, 93.005427, 120.67443, 127.3413, 126.34155, 112.67373, 73.670442, 47.334888 },
                              { 31.833333, 43.000334, 67.333673, 96.667617, 115.66737, 123.00037, 106.00036, 76.00035, 51.333674, 36.000335 },
                              { 23.833333, 38.000334, 70.333673, 101.66757, 125.00063, 111.33393, 90.00053, 63.00045, 37.667042, 25.667006 }},
                             // UT7
                             {{ 35.833333, 43.333665, 74.002021, 106.67013, 124.33717, 123.33746, 113.00367, 91.669417, 59.668031, 40.000513 },
                              { 26.166667, 33.332999, 66.334872, 101.00377, 120.33816, 118.33838, 104.67092, 72.669048, 48.667647, 33.000065 },
                              { 16.166667, 36.666333, 69.332134, 95.332202, 118.66573, 102.66554, 75.665787, 45.666062, 29.332879, 17.999649 }}, 
                             // UT8
                             {{ 22.5, 27.666667, 55.664523, 102.32737, 122.65961, 127.3256, 122.99291, 104.32756, 58.664116, 27.332992 },
                              { 36.166667, 48.999668, 79.333002, 105.0002, 122.00033, 117.00029, 101.00017, 73.999959, 52.333126, 42.666385 },
                              { 37.833333, 49.333665, 69.334574, 95.669275, 126.33664, 114.66987, 98.669272, 70.001534, 52.000861, 41.333796 }},
                             // UT9
                             {{ 19.5, 33, 66.5, 100.5, 120, 126, 122, 97.5, 63, 30.5 },
                              { 40.5, 48.5, 65, 92, 115.5, 124.5, 117, 98.5, 65.5, 46.5 },
                              { 33.5, 47, 82.5, 111.5, 129, 127, 105, 75, 51.5, 38 }},

                            };

        double[,,] LowerX = { // LT1
                              {{ 27.5, 45.5, 52.5, 49.5, 45, 31.5, 14.5, 6.5, 3.5, 9.5 },
                               { 75, 91.5, 98.5, 98.5, 91.5, 76.5, 62, 53.5, 53, 57 },
                               { 114, 129.5, 139.5, 141.5, 143, 131, 111, 98, 94, 96 }},
                              // LT2
                              {{ 6.3333333, 46.167, 48.49998, 48.16665, 45.166675, 41.83337, 34.166767, 16.500248, 4.8336794, 3.1673725 },
                               { 52.333333, 88.166999, 97.166583, 96.166264, 90.83302, 86.499759, 79.166549, 56.83359, 46.833758, 48.50072 },
                               { 119.33333, 130.83367, 141.50097, 143.16767, 139.16729, 119.50034, 98.500036, 88.166557, 94.499686, 100.49981 }},
                              // LT3
                              {{ 14, 49.166667, 56.499599, 52.832967, 46.499694, 30.833175, 15.499986, 3.500099, 2.8334386, 5.8337251 },
                               { 65, 93.5, 103.5, 104.5, 102.5, 93.166667, 75.833333,  64.5, 55.166667, 57.499684 }, 
                               { 114.66667, 126.833, 136.83361, 141.16745, 141.16745, 131.16682, 117.83309, 104.49936, 101.83261, 104.49967 }},
                              // LT4
                              {{ 11, 42.833333, 52.167096, 52.167096, 46.833416, 37.833395, 21.500024, 11.166667, 2.8333145, 3.1669796 },
                               { 60, 89.166667, 98.499557, 98.832887, 95.833228, 91.499907, 82.833266, 68.833307, 55.166681, 52.166332 },
                               { 117.33333, 128.50034, 139.50034, 142.83367, 138.83395, 119.50036, 107.83355, 97.83385, 98.834176, 108.5008 }},
                              // LT5
                              {{ 8, 42.166667, 50.166257, 49.16594, 46.499321, 40.499427, 21.833089, 9.1666461, 6.5000265, 3.5000797 },
                               { 53, 89.166667, 95.166275, 97.499235, 98.832548, 92.166282, 75.499779, 57.833286, 49.166704, 49.166704 },
                               { 107, 122.5, 135.5, 140.16667, 137.4997, 127.16647, 112.16662, 98.500084, 95.833444, 97.833741 }},
                              // LT6
                              {{ 6, 37.5, 46.833333, 48.500346, 44.833651, 41.833626, 22.500135, 9.1666925, 6.166668, 0.49995508 },
                               { 51.333333, 80.166999, 93.166517, 96.166128, 97.499094, 89.832631, 68.833195, 54.500247, 49.500381, 47.167111 },
                               { 107.33333, 123.83367, 136.50093, 141.83437, 140.16798, 118.50067, 105.16694, 95.832909, 93.833179, 99.833658 }},
                              // LT7
                              {{ 4.6666667, 40.499667, 47.499668, 46.166335, 42.499668, 29.833001, 15.166334, 5.1663332, 6.1663332, 1.4996664 },
                               { 52.666667, 87.833001, 94.166727, 95.833061, 98.500086, 88.499993, 70.49983, 57.499712, 49.166303, 46.499259 },
                               { 107, 123.83333, 133.83387, 141.16776, 140.8341, 129.50051, 116.50021, 100.49985, 93.166357, 96.499457 }},
                              // LT8
                              {{ 7.6666667, 41.833, 48.833402, 49.833752, 47.500692, 45.50064, 18.499945, 8.166346, 6.1662946, 3.1658611 },
                               { 60, 93.5, 97.833333, 93.833634, 90.166934, 80.166846, 65.166713, 52.83327, 49.8336, 52.167253 },
                               { 111, 125.83333, 134.83387, 142.16781, 137.83404, 122.83364, 108.16659, 96.832522, 96.832522, 99.499596 }},
                              // LT9
                              {{ 11, 40.166667, 49.166232, 47.499267, 43.499347, 38.166121, 17.499869, 9.5000301, 7.1667441, 5.1664352 },
                               { 60.666667, 87.833001, 96.833444, 96.833444, 96.500436, 89.166945, 66.833133, 50.832791, 47.499743, 51.499801 },
                               { 110.66667, 124.49966, 134.16633, 139.83259, 140.49959, 129.83295, 117.16631, 96.833033, 95.166714, 103.83303 }}
                            };

        double[,,] LowerY = { // LT1
                              {{ 19, 20.5, 33.5, 62.5, 90, 99, 93, 64.5, 38, 19 },
                               { 15, 17, 27.5, 52, 87, 96.5, 88, 60, 34, 17 },
                               { 2, 11, 33.5, 58, 83.5, 98.5, 93, 64.5, 42.5, 19.5 }},
                              // LT2
                              {{ 8, 8.5, 15.833333, 30.500957, 62.835667, 85.170419, 93.170439, 92.836761, 62.502202, 15.83365 },
                               { 9, 7.8333333, 16.831095, 44.491213, 66.485737, 88.147018, 95.811413, 94.478749, 60.153966, 14.831923 },
                               { 5, 7.1666667, 30.496076, 64.490845, 96.152639, 103.15121, 99.151517, 81.487693, 43.160526, 14.498472 }},
                              // LT3
                              {{ 6, 6.8333333, 12.169135, 42.179188, 72.855855, 85.193743, 75.19003, 53.182599, 21.838681, 8.5008444 },
                               { 7.6666667, 5.8329998, 8.8327879, 49.496911, 74.828451, 92.160978, 83.827895, 62.496049,37.831102, 10.499674 },
                               { 4.3333333, 13.167, 33.499232, 61.498177, 84.83063, 94.497302, 77.164549, 62.498376, 37.832539, 9.5001596 }},
                              // LT4
                              {{ 8.6666667, 7.499667, 14.166333, 35.831581, 60.497636, 79.163586, 80.163213, 65.83023, 36.49829, 12.832747 },
                               { 8.3333333, 7.8336663, 16.494889, 39.146444, 60.464993, 77.786585, 81.451116, 77.1207, 51.804405, 12.497527 },
                               { 7, 19.166667, 51.498779, 82.497929, 99.830791, 92.164637, 75.498368, 49.832313, 15.499797, 4.5000596 }},
                              // LT5
                              {{ 7, 5.5, 12.833333, 45.835165, 81.170725, 96.837827, 90.837846, 64.50312, 37.835043, 14.167125 },
                               { 7.6666667, 8.8329998, 17.50248, 45.177061, 77.519027, 106.86049, 104.52684, 77.185838, 49.844833, 12.501023 },
                               { 4, 19.166667, 48.165694, 75.164564, 95.830193, 97.830465, 85.831124, 65.165016, 32.832555, 10.1665 }},
                              // LT6
                              {{ 6.6666667, 5.1663332, 10.167111, 37.504359, 67.175639, 87.178304, 92.512085, 74.176075, 42.171402, 18.167898 },
                               { 8, 6.1666667, 11.834031, 40.841349, 79.851454, 99.85689, 96.856445, 73.183659, 51.844809, 21.837051 },
                               { 2.6666667, 19.499667, 46.832999, 75.833552, 87.167353, 92.167058, 74.166648, 49.499873, 18.499736, 7.1663532 }},
                              // LT7
                              {{ 6, 3.8333333, 8.4996155, 57.492082, 82.154954, 93.819443, 82.821474, 57.825332, 38.161701, 15.831814 },
                               { 7.6666667, 8.4996665, 13.832998, 51.168667, 82.169759, 100.50352, 100.17018, 78.169263, 55.168307, 30.500615 },
                               { 4, 20.833333, 44.167464, 69.500759, 89.500986, 93.834367, 85.834578, 67.834304, 31.833757, 9.5000836 }},
                              // LT8
                              {{ 11.666667, 7.8330003, 14.832725, 40.498718, 63.831136, 88.497313, 91.497215, 69.164625, 41.832202, 18.832967 },
                               { 8.3333333, 10.500333, 18.500332, 55.833661, 82.834179, 91.501282, 87.834573, 71.167716, 37.167329, 11.500369 },
                               { 2.6666667, 19.166333, 42.165537, 63.831253, 81.164519, 85.497402, 74.4977, 49.831708, 29.832256, 12.832722 }},
                              // LT9
                              {{ 11.666667, 11.166334, 18.837784, 44.523033, 77.212926, 90.221773, 91.222139, 70.540721, 40.519795, 16.169487 },
                               { 9, 9, 20.5, 56.5, 77.5, 94.833333, 86.166969, 58.833528, 31.833423, 12.166679 },
                               { 4, 7.5, 31.833333, 59.167329, 83.167137, 97.833496, 86.167101, 44.500214, 17.166736, 9.8333642 }}
                            };

        #endregion 

        public ToothList UpperTooth, LowerTooth;
        public Dictionary<string, int> dic;
        public Point UpperGuide, LowerGuide;

        public TeethTemplate_Step()
        {
            InitializeComponent();
            this.DataContext = new TeethControlViewModel();

            // Set data for UpperTooth.
            UpperTooth = new ToothList();
            UpperGuide = new Point(0, 0);

            LowerTooth = new ToothList();
            LowerGuide = new Point(0, 0);

            for (int k = 0; k < 9; k++)
            {
                ToothType tooth_upper = new ToothType();
                ToothType tooth_lower = new ToothType();
                for (int i = 0; i < 6; i++)
                {
                    TeethType teeth_upper = new TeethType();
                    TeethType teeth_lower = new TeethType();
                    for (int j = 0; j < 10; j++)
                    {
                        if (i >= 0 && i < 3)
                        {
                            teeth_upper.Add(new PointViewModel(UpperX[k, i, j] + UpperGuide.X, UpperY[k, i, j] + UpperGuide.Y, j));
                            teeth_lower.Add(new PointViewModel(LowerX[k, i, j] + LowerGuide.X, LowerY[k, i, j] + LowerGuide.Y, j));
                        }
                        else
                        {
                            teeth_upper.Add(new PointViewModel(-1 * UpperX[k, i - 3, j] + UpperGuide.X, UpperY[k, i - 3, j] + UpperGuide.Y, j));
                            teeth_lower.Add(new PointViewModel(-1 * LowerX[k, i - 3, j] + LowerGuide.X, LowerY[k, i - 3, j] + LowerGuide.Y, j));
                        }
                    }
                    tooth_upper.Add(teeth_upper);
                    tooth_lower.Add(teeth_lower);
                }
                UpperTooth.Add(tooth_upper);
                LowerTooth.Add(tooth_lower);
            }

            // Set global dictionary.
            dic = new Dictionary<string, int>();
            dic.Add("CanineL", 5);
            dic.Add("LateralIncisorL", 4);
            dic.Add("CentralIncisorL", 3);
            dic.Add("CentralIncisorR", 0);
            dic.Add("LateralIncisorR", 1);
            dic.Add("CanineR", 2);          
        }
    }
}
