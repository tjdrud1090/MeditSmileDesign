using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using Process_Page.ToothTemplate;
using Process_Page.ViewModel;

namespace Process_Page.Cards
{
    using ToothList = ObservableCollection<ObservableCollection<ObservableCollection<PointViewModel>>>;
    using ToothType = ObservableCollection<ObservableCollection<PointViewModel>>;
    using TeethType = ObservableCollection<PointViewModel>;

    public partial class TeethTemplate_Step : UserControl
    {
        #region PointsData

        double[,,] UpperX = {
                             // UT1
                             {{ 25.1660038, 50.3326708, 61.9988508, 70.6658158, 71.3324768, 58.9989508, 7.9995328, 0, 1.6669645, 12.3334038},
                              { 89.1660038, 110.332673, 120.9988338, 129.3324538, 126.3321538, 114.9989838, 85.3327238, 72.3324688, 70.6654698, 78.6654668},
                              { 164.4993338, 169.3329938, 171.9991438, 161.6664038, 150.3333438, 122.6666038, 119.9999538, 123.3335738, 133.0000938, 149.6664938}},

                             // UT2
                             {{ 20.1678812, 52.3342132, 61.3346412, 69.3351232, 74.0022402,66.3353772, 7.6672322, 0, 5.3334947, 11.6670192},
                              { 80.8345472, 116.6682142, 123.6678142, 128.0007342, 127.3340842, 109.3343942, 83.0015132, 71.3350462, 71.3350462, 73.3353332},
                              { 161.8345442, 169.6682042, 173.3343842, 169.0014442, 151.3350142, 128.3360042, 119.0033442, 126.3364142, 136.3360542, 149.3355842 }},

                             // UT3
                             {{ 41.8341099, 62.3344419, 72.3349359, 78.6687749, 71.3349769, 39.0010579, 4.6671053, 0, 6.6668169, 20.0004519},
                              { 102.5007769, 123.3341069, 128.0011869, 129.6678869, 125.3341969, 118.0008369, 83.3340399, 77.3343989, 74.6680959, 81.0010719 },
                              { 163.5007769, 172.6674469, 174.3337269, 172.6673969, 158.3341369, 136.0017069, 121.3354169, 126.6689169, 136.6685969, 152.0014369} },

                             // UT4
                             {{ 38.1653526, 62.6650206, 71.6645666, 72.6642066, 61.6642376, 8.3326796, 0, 0.3333203, 6.3330896, 17.3326666},
                              { 111.1653556, 121.6650156, 123.6646256, 118.9978956, 108.6651656, 80.6658226, 72.9990366, 72.6657126, 78.3319276, 91.6649766},
                              { 161.8320156, 165.9990156, 167.6656956, 160.6657456, 150.6654756, 130.6648656, 118.3309256, 120.9979756, 128.6647556, 145.9983556} },

                             // UT5
                             {{ 40.5010659, 61.0007339, 66.6669769, 69.6673029, 57.6675369, 13.0005139, 0, 0.3330064, 7.6664769, 23.3334359 },
                              { 108.1677289, 119.3347389, 122.0013989, 122.6677189, 118.0013889, 104.3347389, 80.6681049, 70.3352039, 69.6685469, 81.0020339 },
                              { 166.1677289, 169.3347289, 166.0013889, 159.0003389, 139.6640589, 126.3294189, 119.3285389, 125.3292789, 134.3303989, 150.9991289}},

                             // UT6
                             {{ 36.8330428, 54.3330428, 63.6663758, 69.0001118, 61.6664288, 52.3330758, 6.6663118, 0, 0.6663346, 9.9996828},
                              {108.1663728, 119.0000428, 121.9996128, 119.9994028, 109.0000028, 79.6682688, 68.6692918, 66.0031428, 77.3354288, 92.0011738 },
                              { 163.8330428, 167.9997128, 165.3329228, 157.3335528, 138.6683728, 123.3367628, 117.6705928, 125.0035528, 138.3355928, 153.3341328}},

                             // UT7
                             {{ 39.8338304, 62.0001644, 70.3339554, 70.0002894, 60.3335824, 6.6666944, 0, 0, 4.3336644, 19.3336554 },
                              { 106.1671634, 121.6671634, 123.6671634, 124.6671634, 108.6671634, 78.6671634, 71.3338304, 70.6668234, 74.3335104, 88.6669344},
                              { 161.5004934, 168.0008234, 168.0008234, 160.0007434, 143.3342634, 126.0002034, 121.3338034, 125.3335634, 131.6670334, 147.0007034 }},

                             // UT8
                             {{ 40.8340096, 61.6673426, 73.3345276, 78.0012696, 67.0008586, 37.3339856, 12.0004776, 0, 2.9997154, 16.6666046},
                              { 108.1673396, 125.3343496, 130.0010096, 130.0010096, 109.6676596, 89.0013006, 78.0010416, 76.3340406, 78.6673726, 92.0006996},
                              {158.8340096, 173.6673396, 172.3343096, 170.0009196, 158.6673396, 142.3343396, 132.6676796, 130.0013596, 133.3343696, 145.0010196 }},

                             // UT9
                             {{ 43, 64.5, 72.5, 71, 67.5, 36.5, 3.5, 0, 4.5, 17.5 },
                              { 106.5, 123, 126, 123.5, 118.5, 98, 78.5, 71.5, 72.5, 84.5},
                              { 157.5, 172, 166.5, 156.5, 147, 133.5, 124.5, 125.5, 131.5, 141 }},
        };

        double[,,] UpperY = {
                             // UT1
                             {{ 19.166667, 18.999666, 28.999655, 63.999615, 115.33289, 127.33325, 127.66691, 113.33322,  65.333106, 28.666355 },
                              { 29.833333, 29.833333, 41.000334, 75.000341, 101.33368, 118.00076, 120.33411, 102.00095, 64.333962, 39.667085 },
                              { 16.833333, 48.000334, 75.333671, 107.66752, 127.00057, 109.66719, 83.333807, 58.333754, 37.33371, 20.000341 }},
                             // UT2
                             {{ 14.5, 14.333333, 21.652376, 61.237815,  105.48138, 123.44441, 124.44203, 113.79681, 59.907081, 24.978551 },
                              { 26.166667, 25.332999, 42.992922, 69.982099, 101.63608, 118.29566, 117.2964, 98.637224, 68.982468, 43.992506 },
                              { 14.5, 33, 59, 93, 125.33333, 102.00027, 82.666873, 52.000114, 34.000059, 23.000026 }},
                             // UT3
                             {{ 18.5, 25.666667, 45.665401, 79.996381, 110.99456, 115.99427, 108.99467, 84.996087, 49.998146, 24.33299 },
                              { 30.166667, 33.666333, 56.330504, 82.995303, 102.99365, 112.65951, 110.65936, 98.9937, 74.329171, 49.664643 },
                              { 29.833333, 45.333667, 69.667858, 106.00134, 127.33496, 116.33511, 89.001321, 61.000854, 46.667282, 36.000437 }},
                             // UT4
                             {{ 22.166667, 35.332999, 65.334095, 107.66916, 127.66941, 127.66941, 117.00213, 87.001353, 56.66723, 35 },
                              { 30.833333, 45.333667, 75.334692, 109.33607, 124.00358, 123.67023, 110.33644, 85.335565, 60.668039,  38.000584 },
                              { 16.833333, 36.000334, 63.667005, 88.999825, 124.66624, 121.66593, 103.99945, 70.999783, 46.333367, 24.333591 } },
                             // UT5
                             {{ 34.833333, 43.000332, 76.000331, 103.66699, 125.99988, 126.99988, 108.3333, 79.000114, 54.333569, 39.333643 },
                              { 27.833333, 36.333667, 63.668408, 87.33545, 107.66984, 119.33654, 121.33694, 107.00339, 70.001962, 41.000842 },
                              { 26.833333, 54.333667, 80.334317, 101.66838, 125.66838, 114.00126, 93.667708, 70.667465, 50.667253, 35.333757 }},
                             // UT6
                             {{ 32.833333, 37.333665, 63.335915, 93.005427, 120.67443, 127.3413, 126.34155, 112.67373, 73.670442, 47.334888 },
                              { 31.833333, 43.000334, 67.333673, 96.667617, 115.66737, 123.00037, 106.00036, 76.00035, 51.333674, 36.000335 },
                              { 23.833333, 38.000334, 70.333673, 101.66757, 125.00063, 111.33393, 90.00053, 63.00045, 37.667042, 25.667006 }},
                             // UT7
                             {{ 35.833333, 43.333665, 74.002021, 106.67013, 124.33717, 123.33746, 113.00367, 91.669417, 59.668031, 40.000513 },
                              { 26.166667, 33.332999, 66.334872, 101.00377, 120.33816, 118.33838, 104.67092, 72.669048, 48.667647, 33.000065 },
                              { 16.166667, 36.666333, 69.332134, 95.332202, 118.66573, 102.66554, 75.665787, 45.666062, 29.332879, 17.999649 }}, 
                             // UT8
                             {{ 22.5, 27.666667, 55.664523, 102.32737, 122.65961, 127.3256, 122.99291, 104.32756, 58.664116, 27.332992 },
                              { 36.166667, 48.999668, 79.333002, 105.0002, 122.00033, 117.00029, 101.00017, 73.999959, 52.333126, 42.666385 },
                              { 37.833333, 49.333665, 69.334574, 95.669275, 126.33664, 114.66987, 98.669272, 70.001534, 52.000861, 41.333796 }},
                             // UT9
                             {{ 19.5, 33, 66.5, 100.5, 120, 126, 122, 97.5, 63, 30.5 },
                              { 40.5, 48.5, 65, 92, 115.5, 124.5, 117, 98.5, 65.5, 46.5 },
                              { 33.5, 47, 82.5, 111.5, 129, 127, 105, 75, 51.5, 38 }},

                            };

        double[,,] LowerX = { // LT1
                              {{ 24, 42, 49, 46, 41.5, 28, 11, 3, 0, 6 },
                               { 4, 88, 95, 95, 88, 73, 58.5, 50, 49.5, 53.5 },
                               { 110.5, 126, 136, 137.5, 139.5, 127.5, 107.5, 94.5, 90.5, 92.5 }},

                              // LT2
                              {{ 3.1659608, 42.9996275, 45.3326075, 44.9992775, 41.9993025, 38.6659975, 30.9993945, 13.3328755, 1.6663069, 0 },
                               { 49.1659605, 84.9996265, 93.9992105, 92.9988915, 87.6656475, 83.3323865, 75.9991765, 53.6662175, 43.6663855, 45.3333475 },
                               { 116.1659575, 127.6662975, 138.3335975, 140.0002975, 135.9999175, 116.3329675, 95.3326635, 84.9991845, 91.3323135, 97.3324375 }},

                              // LT3
                              {{ 116.1659575, 127.6662975, 138.3335975, 140.0002975, 135.9999175, 116.3329675, 95.3326635, 84.9991845, 91.3323135, 97.3324375 },
                               { 62.1665614, 90.6665614, 100.6665614, 101.6665614, 99.6665614, 90.3332614, 72.9998614, 61.6665614, 52.3332314, 54.6662454 },
                               { 111.8332314, 123.9995614, 134.0001714, 138.3340114, 138.3340114, 128.3333814, 114.9996514, 101.6659214, 98.9991714, 101.6661614 }},

                              // LT4
                              {{ 8.1666855, 40.0000185, 49.3337815, 49.3337815, 44.0001015, 35.0000805, 18.6667095, 8.3333525, 0, 0.3336651 },
                               { 57.1666855, 86.3333525, 95.6662425, 95.9995725, 92.9999135, 88.6665925, 79.9999515, 65.9999925, 52.3333665, 49.3330175 },
                               { 114.5000155, 125.6670255, 136.6670255, 140.0003555, 136.0006355, 116.6670455, 105.0002355, 95.0005355, 96.0008615, 105.6666855 }},

                              // LT5
                              {{ 4.499921, 38.666588, 46.666178, 45.665861, 42.999242, 36.999348, 18.33301, 5.6665671, 2.9999475, 0 },
                               { 49.499921, 85.666588, 91.666196, 93.999156, 95.332469, 88.666203, 71.9997, 54.333207, 45.666625, 45.666625 },
                               { 103.499921, 118.999921, 131.999921, 136.666621, 133.999621, 123.666391, 108.666541, 95.000005, 92.333365, 94.333661 }},

                              // LT6
                              {{ 5.500045, 37.000045, 46.333378, 48.000391, 44.333696, 41.333671, 22.00018, 8.6667375, 5.666713, 0},
                               { 50.833378, 79.667044, 92.666562, 95.666173, 96.999139, 89.332676, 68.33324, 54.000292, 49.000426, 46.667155 },
                               { 106.833375, 123.333715, 136.000975, 141.334415, 139.668025, 118.000715, 104.666985, 95.332954, 93.333224, 99.333695 }},

                              // LT7
                              {{ 3.1670003, 39.0000006, 46.0000016, 44.6666686, 41.0000016, 28.3333346, 13.6666676, 3.6666668, 4.6666668,0 },
                               { 51.1670006, 86.3333346, 92.6670606, 94.3333946, 97.0004196, 87.0003266, 69.0001636, 56.0000456, 47.6666366, 44.9995836 },
                               { 105.5003336, 122.3336636, 132.3342036, 139.6680936, 139.3344336, 128.0008436, 115.0005436, 99.0001836, 91.6666906, 94.9997906 }},

                              // LT8
                              {{ 4.5008057, 38.667139, 45.667541, 46.667891, 44.334831, 42.334779, 15.334084, 5.000485, 3.0004336,0 },
                               { 56.834139, 90.334139, 94.667472, 90.667773, 87.001073, 77.000985, 62.000852, 49.667409, 46.667739, 49.001392 },
                               { 107.834139, 122.667469, 131.668009, 139.001949, 134.668179, 119.667779, 105.000729, 93.666661, 93.666661, 96.333729 }},

                              // LT9
                              {{ 5.8335648, 35.0002318, 43.9998, 42.3328318, 38.3329118, 32.9996858, 12.3334338, 4.3335949, 2.0003089,0 },
                               {55.5002318, 82.6665658, 91.6670088, 91.6670088, 91.3340008, 84.0005098, 61.6666978, 45.6663558, 42.3333078, 46.3333658},
                               { 105.5002348, 119.3332248, 128.9998948, 134.6661548, 135.3331548, 124.6665148, 111.9998748, 91.6665978, 90.0002788, 98.6665948 }}
                            };

        double[,,] LowerY = { // LT1
                              {{ 19, 20.5, 33.5, 62.5, 90, 99, 93, 64.5, 38, 19 },
                               { 15, 17, 27.5, 52, 87, 96.5, 88, 60, 34, 17 },
                               { 2, 11, 33.5, 58, 83.5, 98.5, 93, 64.5, 42.5, 19.5 }},
                              // LT2
                              {{ 8, 8.5, 15.833333, 30.500957, 62.835667, 85.170419, 93.170439, 92.836761, 62.502202, 15.83365 },
                               { 9, 7.8333333, 16.831095, 44.491213, 66.485737, 88.147018, 95.811413, 94.478749, 60.153966, 14.831923 },
                               { 5, 7.1666667, 30.496076, 64.490845, 96.152639, 103.15121, 99.151517, 81.487693, 43.160526, 14.498472 }},
                              // LT3
                              {{ 6, 6.8333333, 12.169135, 42.179188, 72.855855, 85.193743, 75.19003, 53.182599, 21.838681, 8.5008444 },
                               { 7.6666667, 5.8329998, 8.8327879, 49.496911, 74.828451, 92.160978, 83.827895, 62.496049,37.831102, 10.499674 },
                               { 4.3333333, 13.167, 33.499232, 61.498177, 84.83063, 94.497302, 77.164549, 62.498376, 37.832539, 9.5001596 }},
                              // LT4
                              {{ 8.6666667, 7.499667, 14.166333, 35.831581, 60.497636, 79.163586, 80.163213, 65.83023, 36.49829, 12.832747 },
                               { 8.3333333, 7.8336663, 16.494889, 39.146444, 60.464993, 77.786585, 81.451116, 77.1207, 51.804405, 12.497527 },
                               { 7, 19.166667, 51.498779, 82.497929, 99.830791, 92.164637, 75.498368, 49.832313, 15.499797, 4.5000596 }},
                              // LT5
                              {{ 7, 5.5, 12.833333, 45.835165, 81.170725, 96.837827, 90.837846, 64.50312, 37.835043, 14.167125 },
                               { 7.6666667, 8.8329998, 17.50248, 45.177061, 77.519027, 106.86049, 104.52684, 77.185838, 49.844833, 12.501023 },
                               { 4, 19.166667, 48.165694, 75.164564, 95.830193, 97.830465, 85.831124, 65.165016, 32.832555, 10.1665 }},
                              // LT6
                              {{ 6.6666667, 5.1663332, 10.167111, 37.504359, 67.175639, 87.178304, 92.512085, 74.176075, 42.171402, 18.167898 },
                               { 8, 6.1666667, 11.834031, 40.841349, 79.851454, 99.85689, 96.856445, 73.183659, 51.844809, 21.837051 },
                               { 2.6666667, 19.499667, 46.832999, 75.833552, 87.167353, 92.167058, 74.166648, 49.499873, 18.499736, 7.1663532 }},
                              // LT7
                              {{ 6, 3.8333333, 8.4996155, 57.492082, 82.154954, 93.819443, 82.821474, 57.825332, 38.161701, 15.831814 },
                               { 7.6666667, 8.4996665, 13.832998, 51.168667, 82.169759, 100.50352, 100.17018, 78.169263, 55.168307, 30.500615 },
                               { 4, 20.833333, 44.167464, 69.500759, 89.500986, 93.834367, 85.834578, 67.834304, 31.833757, 9.5000836 }},
                              // LT8
                              {{ 11.666667, 7.8330003, 14.832725, 40.498718, 63.831136, 88.497313, 91.497215, 69.164625, 41.832202, 18.832967 },
                               { 8.3333333, 10.500333, 18.500332, 55.833661, 82.834179, 91.501282, 87.834573, 71.167716, 37.167329, 11.500369 },
                               { 2.6666667, 19.166333, 42.165537, 63.831253, 81.164519, 85.497402, 74.4977, 49.831708, 29.832256, 12.832722 }},
                              // LT9
                              {{ 11.666667, 11.166334, 18.837784, 44.523033, 77.212926, 90.221773, 91.222139, 70.540721, 40.519795, 16.169487 },
                               { 9, 9, 20.5, 56.5, 77.5, 94.833333, 86.166969, 58.833528, 31.833423, 12.166679 },
                               { 4, 7.5, 31.833333, 59.167329, 83.167137, 97.833496, 86.167101, 44.500214, 17.166736, 9.8333642 }}
                            };

        #endregion 

        public ToothList UpperTooth, LowerTooth;
        public Dictionary<string, int> dic;
        public Point UpperGuide, LowerGuide;

        public TeethTemplate_Step()
        {
            InitializeComponent();
            this.DataContext = new TeethControlViewModel();

            // Set data for UpperTooth.
            UpperTooth = new ToothList();
            UpperGuide = new Point(0, 0);

            LowerTooth = new ToothList();
            LowerGuide = new Point(0, 0);

            for (int k = 0; k < 9; k++)
            {
                ToothType tooth_upper = new ToothType();
                ToothType tooth_lower = new ToothType();
                for (int i = 0; i < 6; i++)
                {
                    TeethType teeth_upper = new TeethType();
                    TeethType teeth_lower = new TeethType();
                    for (int j = 0; j < 10; j++)
                    {
                        if (i >= 0 && i < 3)
                        {
                            teeth_upper.Add(new PointViewModel(UpperX[k, i, j] + UpperGuide.X, UpperY[k, i, j] + UpperGuide.Y, j));
                            teeth_lower.Add(new PointViewModel(LowerX[k, i, j] + LowerGuide.X, LowerY[k, i, j] + LowerGuide.Y, j));
                        }
                        else
                        {
                            teeth_upper.Add(new PointViewModel(-1 * UpperX[k, i - 3, j] + UpperGuide.X, UpperY[k, i - 3, j] + UpperGuide.Y, j));
                            teeth_lower.Add(new PointViewModel(-1 * LowerX[k, i - 3, j] + LowerGuide.X, LowerY[k, i - 3, j] + LowerGuide.Y, j));
                        }
                    }
                    tooth_upper.Add(teeth_upper);
                    tooth_lower.Add(teeth_lower);
                }
                UpperTooth.Add(tooth_upper);
                LowerTooth.Add(tooth_lower);
            }

            // Set global dictionary.
            dic = new Dictionary<string, int>();
            dic.Add("CanineL", 5);
            dic.Add("LateralIncisorL", 4);
            dic.Add("CentralIncisorL", 3);
            dic.Add("CentralIncisorR", 0);
            dic.Add("LateralIncisorR", 1);
            dic.Add("CanineR", 2);          
        }
    }
}
